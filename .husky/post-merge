#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# After merging, if dependency files changed, install, test, and build
FILES=$(git diff --name-only HEAD@{1} HEAD)

echo "$FILES" | grep -E "(^|/)(package\.json|package-lock\.json|npm-shrinkwrap\.json)$" >/dev/null 2>&1

if [ $? -eq 0 ]; then
  echo "Dependency files changed after merge. Installing, testing, and building..."
  npm install || exit 1
  npm test || exit 1
  npm run build || exit 1
fi
